<!DOCTYPE html>
<html lang="">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="stylesheet" href="detalje.css">


</head>

<body>
    <header>
        <nav>
            <a href="index.html">
                <img src="logo.svg" alt="">
            </a>

            <a href="produkter.html">Produkter</a>
            <a href="#">Om</a>
            <a href="#">Kontakt</a>
        </nav>
    </header>

    <section id="detalje" class="">
        <!--
        <button id="fjern-detalje">TILBAGE</button>
        !-->
        <div class="detalje-sko">
            <div class="sko-navn">
                <h2></h2>
                <h1></h1>
            </div>
        </div>

        <div class="beskrivelse">
            <div class="txt">
                <p>Farver: </p>
                <p></p>
                <p></p><br>
                <p></p>
            </div>

            <section id="sizes"></section>
            <template>
                <div id="" class="size">
                    <p></p>
                </div>
            </template>

            <button class="buy">KØB NU</button>
        </div>
    </section>

    <script>
        //Vi definerer et endpoint som er vores Google Sheet aka JSON-fil
        const endpoint = "https://spreadsheets.google.com/feeds/list/1ZPVcO_A1ALH2vKozmQvf5pL-lqHAhTAFL8d3Hz9ifec/od6/public/values?alt=json";
        const detalje = document.querySelector("#detalje"); //detalje defineres som det sted, hvor sko-properties bliver vist
        const urlParams = new URLSearchParams(window.location.search); //urlParams defineres som alt efter spørgsmålstegnet
        const id = urlParams.get("id"); //Vi gemmer det medbragte ID fra URL'en, så vi kan henvise til det senere

        let sneakers = []; //sneakers defineres som et tomt array den skal indeholde alle objekterne fra JSON-filen

        //Når alle elementer i DOM'en er loadet, så skal funktionen "start" igangsættes
        document.addEventListener("DOMContentLoaded", start);


        function start() {
            hentData(); //Vi kalder funktionen hentData, så vi kan skaffe objekterne fra JSON-filen
        }

        //Der laves en async funktion til at skaffe dataen fra JSON-filen
        async function hentData() {
            const response = await fetch(endpoint); //variablen "response" defineres og skal hente dataen fra endpoint-URL'en
            sneakers = await response.json(); //sneakers-array får dataen i response fra JSON-filen
            console.log(sneakers);
            visSneakers(); //funktionen "visSneakers" kaldes
        }


        function visSneakers() {
            //hvert objekt i array'et "sneakers" kaldes sko & viser forskellige sko-properties i en article
            sneakers.feed.entry.forEach(sko => {
                //Vi spørger om sko-objekternes id-property har samme værdi som variablen id // se linje 128
                if (sko.gsx$id.$t == id) {
                    document.title = sko.gsx$brand.$t + " " + sko.gsx$navn.$t + " | Say Sneaks"; //Fanens titel sættes = navnet på skoen

                    console.log(sko.gsx$navn.$t);
                    /*

                    detalje.querySelector("p").textContent = sko.gsx$farve.$t; //skoens farver tilføjes til p-taggets eksisterende indhold
                    detalje.querySelector("p + p").textContent = sko.gsx$pris.$t + ",-"; //skoens pris tilføjes til p-tag
                    detalje.querySelector("p + p + br + p").textContent = "Tilgængelige størrelser:"; //
                    */

                    detalje.querySelector(".txt p").textContent += sko.gsx$farve.$t;
                    detalje.querySelector(".txt p:nth-child(2)").textContent = sko.gsx$lang.$t; //skoens farver tilføjes til p-taggets eksisterende indhold
                    detalje.querySelector(".txt p:nth-child(3)").textContent = sko.gsx$pris.$t + ",-"; //skoens pris tilføjes til p-tag
                    detalje.querySelector(".txt p:last-child").textContent = "Tilgængelige størrelser:"; //

                    detalje.querySelector("h2").textContent = sko.gsx$brand.$t + " " + sko.gsx$navn.$t; //skoens brand/navn vises i h2-tag
                    detalje.querySelector("h1").textContent = sko.gsx$h1.$t; //skoens model vises i h1-tag

                    //skoens billede angives som source til img-tag
                    detalje.querySelector(".detalje-sko").style.backgroundImage = "url(imgs/large/" + sko.gsx$billede.$t + ".jpg)";

                    let size = sko.gsx$size.$t.split(", "); //Skoens størrelser splittes op efter komma-separering og puttes i et array "size"
                    let container = document.querySelector("#sizes"); //container definerer hvor de enkelte størrelser skal vises
                    let sneakerTemplate = document.querySelector("template"); //sneakerTemplate defineres som udgangspunktet for størrelserne

                    //Hver størrelse i array'et "size" skal klone udgangspunktet og indsætte størrelsen som tekst
                    size.forEach(størrelse => {
                        console.log(størrelse);
                        //Variablen "klon" defineres til at lave article-kloner baseret på antallet af objekter
                        let klon = sneakerTemplate.cloneNode(true).content;
                        klon.querySelector("p").textContent = størrelse; //p-taggets indhold sættes lig den enkelte størrelse
                        container.appendChild(klon); //Alle de klonede elementer vises i container
                    });

                    //klikker man på tilbage-knappen, så sendes man tilbage i ens browser-historik
                    /*
                    detalje.querySelector("#fjern-detalje").addEventListener("click", () => {
                        history.back();
                    });
                    */
                }
            });

        }

    </script>
</body>

</html>
